<VirtualHost *:80>
    ServerAdmin webmaster@localhost
    ServerName app.division5.co
    ServerAlias www.app.division5.co

    # Enable the rewrite engine for WebSocket support
    RewriteEngine On
    RewriteCond %{HTTP:Upgrade} websocket [NC]
    RewriteRule /(.*) ws://localhost:8080/$1 [P,L]

    # Proxy to Nginx on port 8080 (which handles frontend and backend routing)
    ProxyPreserveHost On
    ProxyPass / http://localhost:8080/
    ProxyPassReverse / http://localhost:8080/

    # WebSocket proxy settings
    ProxyPass /api ws://localhost:8080/api upgrade=websocket
    ProxyPassReverse /api ws://localhost:8080/api

    # Logging
    ErrorLog ${APACHE_LOG_DIR}/app-division5-error.log
    CustomLog ${APACHE_LOG_DIR}/app-division5-access.log combined
</VirtualHost>

# vim: syntax=apache ts=4 sw=4 sts=4 sr noet

